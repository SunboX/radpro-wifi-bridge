<!DOCTYPE html>
<html lang="{{LOCALE}}">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Firmware Update</title>
        <link rel="stylesheet" href="/portal/portal.css" />
    </head>
    <body class="invert" data-i18n-title="T_PAGE_OTA" data-portal-locale-value="{{LOCALE}}">
        <div class="wrap">
            <h1 data-i18n="T_PAGE_OTA">Firmware Update</h1>
            <p class="notice {{NOTICE_CLASS}}">{{NOTICE_TEXT}}</p>
            <section>
                <h2 data-i18n="T_SECTION_REMOTE_OTA">Update Via Internet</h2>
                <p data-i18n="T_REMOTE_OTA_DESC">
                    The bridge can download the latest signed build from the official repository.
                </p>
                <dl class="ota-version-grid">
                    <dt data-i18n="T_LABEL_CURRENT_VERSION">Current firmware</dt>
                    <dd id="otaCurrentVersion">—</dd>
                    <dt data-i18n="T_LABEL_LATEST_VERSION">Latest available</dt>
                    <dd>
                        <span id="otaLatestVersion">—</span>
                        <small id="otaLatestStatus" class="ota-latest-status"></small>
                    </dd>
                </dl>
                <div class="ota-actions">
                    <button type="button" id="otaFetchBtn" data-i18n="T_REMOTE_BUTTON">
                        Download &amp; Install Latest Build
                    </button>
                    <button type="button" id="otaCancelBtn" class="secondary" data-i18n="T_REMOTE_CANCEL">
                        Cancel Update
                    </button>
                </div>
                <div class="ota-progress">
                    <div id="otaStatusText" class="ota-status-text" data-i18n="T_REMOTE_STATUS_IDLE">Idle.</div>
                    <div class="ota-progress-bar">
                        <div id="otaProgressFill" class="ota-progress-bar-fill"></div>
                    </div>
                    <div id="otaProgressNumbers" class="ota-progress-numbers"></div>
                </div>
            </section>
            <section>
                <h2 data-i18n="T_SECTION_MANUAL_OTA">Manual Firmware Upload</h2>
                <p data-i18n="T_MANUAL_OTA_DESC">
                    Upload a ZIP file that contains manifest.json and all required .bin files.
                </p>
                <input type="file" id="otaFileInput" accept="application/zip,.zip" />
                <button type="button" id="otaUploadBtn" data-i18n="T_MANUAL_BUTTON">Upload Firmware ZIP</button>
                <p id="otaUploadMessage" class="client-msg"></p>
            </section>
            <form action="/" method="get" class="back-form">
                <button type="submit" data-i18n="T_BUTTON_BACK">Back to Main Menu</button>
            </form>
        </div>
        <script src="/portal/portal-locale.js"></script>
        <script src="/portal/js/jszip.min.js"></script>
        <script src="/portal/js/ota-page.js"></script>
    </body>
</html>
